import{u as p,m as _,i as y,T as m,c as F,h as w,l as g,a as $,p as b,b as E,x as v,y as A,o as M,d as T,g as x,j as z,V as B,q as C,A as L,L as U,B as k,O as I,w as V,E as D,F as G,I as S,U as j,M as q,S as J,k as K,v as N,z as P,C as Q,D as R,G as W,H as X}from"./BufferView-CkAzLrFo.js";import{eO as Y}from"./index-BHVnKyhT.js";class Z{constructor(t){this.message=t}toString(){return`AssertException: ${this.message}`}}function tt(s,t="Assertion"){if(!s){const e=new Error(t).stack;throw new Z(`${t} at ${e}`)}}function nt(s,t){s||(t=t||"",console.warn("Verify failed: "+t+`
`+new Error("verify").stack))}function ut(s,t,e,r){let i,n=(e[0]-s[0])/t[0],u=(r[0]-s[0])/t[0];n>u&&(i=n,n=u,u=i);let f=(e[1]-s[1])/t[1],h=(r[1]-s[1])/t[1];if(f>h&&(i=f,f=h,h=i),n>h||f>u)return!1;f>n&&(n=f),h<u&&(u=h);let d=(e[2]-s[2])/t[2],a=(r[2]-s[2])/t[2];return d>a&&(i=d,d=a,a=i),!(n>a||d>u)&&(a<u&&(u=a),!(u<0))}function ht(s,t,e,r,i,n=Y()){const u=(r[i]-e[i])*(t[0]-s[0])-(r[0]-e[0])*(t[i]-s[i]),f=(r[0]-e[0])*(s[i]-e[i])-(r[i]-e[i])*(s[0]-e[0]);if(u===0)return!1;const h=f/u;return n[0]=s[0]+h*(t[0]-s[0]),n[1]=s[i]+h*(t[i]-s[i]),!0}function ft(s,t){return Math.log(s)/Math.log(t)}function at(s){return s[0]===1&&s[1]===0&&s[2]===0&&s[3]===0&&s[4]===0&&s[5]===1&&s[6]===0&&s[7]===0&&s[8]===0&&s[9]===0&&s[10]===1&&s[11]===0&&s[15]===1}function l(s){switch(s){case"u8":case"i8":return 1;case"u16":case"i16":return 2;case"u32":case"i32":case"f32":return 4;case"f64":return 8}}class o{constructor(t,e){this.layout=t,this.buffer=typeof e=="number"?new ArrayBuffer(e*t.stride):e;for(const r of t.fields.keys()){const i=t.fields.get(r);this[r]=new i.constructor(this.buffer,i.offset,this.stride)}}get stride(){return this.layout.stride}get count(){return this.buffer.byteLength/this.stride}get byteLength(){return this.buffer.byteLength}getField(t,e){const r=this[t];return r&&r.elementCount===e.ElementCount&&r.elementType===e.ElementType?r:null}slice(t,e){return new o(this.layout,this.buffer.slice(t*this.stride,e*this.stride))}copyFrom(t,e=0,r=0,i=t.count){const n=this.stride;if(n%4==0){const u=new Uint32Array(t.buffer,e*n,i*n/4);new Uint32Array(this.buffer,r*n,i*n/4).set(u)}else{const u=new Uint8Array(t.buffer,e*n,i*n);new Uint8Array(this.buffer,r*n,i*n).set(u)}return this}get cachedMemory(){return this.byteLength}dispose(){}}class c{constructor(t){this._stride=0,this._lastAligned=0,this._fields=new Map,t&&(this._stride=t.stride,t.fields.forEach(e=>this._fields.set(e[0],{...e[1],constructor:st(e[1].constructor)})))}freeze(){return this}vec2f(t,e){return this._appendField(t,p,e),this}vec2f64(t,e){return this._appendField(t,_,e),this}vec3f(t,e){return this._appendField(t,y,e),this}vec3f64(t,e){return this._appendField(t,m,e),this}vec4f(t,e){return this._appendField(t,F,e),this}vec4f64(t,e){return this._appendField(t,w,e),this}mat3f(t,e){return this._appendField(t,g,e),this}mat3f64(t,e){return this._appendField(t,$,e),this}mat4f(t,e){return this._appendField(t,b,e),this}mat4f64(t,e){return this._appendField(t,E,e),this}vec4u8(t,e){return this._appendField(t,v,e),this}f32(t,e){return this._appendField(t,A,e),this}f64(t,e){return this._appendField(t,M,e),this}u8(t,e){return this._appendField(t,T,e),this}u16(t,e){return this._appendField(t,x,e),this}i8(t,e){return this._appendField(t,z,e),this}vec2i8(t,e){return this._appendField(t,B,e),this}vec2i16(t,e){return this._appendField(t,C,e),this}vec2u8(t,e){return this._appendField(t,L,e),this}vec4u16(t,e){return this._appendField(t,U,e),this}u32(t,e){return this._appendField(t,k,e),this}_appendField(t,e,r){if(this._fields.has(t))return void tt(!1,`${t} already added to vertex buffer layout`);const i=e.ElementCount*l(e.ElementType),n=this._stride;this._stride+=i,this._fields.set(t,{size:i,constructor:e,offset:n,optional:r})}createBuffer(t){return new o(this,t)}createView(t){return new o(this,t)}clone(){const t=new c;return t._stride=this._stride,t._fields=new Map,this._fields.forEach((e,r)=>t._fields.set(r,e)),t.BufferType=this.BufferType,t}get stride(){if(this._lastAligned!==this._fields.size){let t=1;this._fields.forEach(e=>t=Math.max(t,l(e.constructor.ElementType))),this._stride=Math.floor((this._stride+t-1)/t)*t,this._lastAligned=this._fields.size}return this._stride}get fields(){return this._fields}}function dt(){return new c}class ot{constructor(t){this.fields=new Array,t.fields.forEach((e,r)=>{const i={...e,constructor:O(e.constructor)};this.fields.push([r,i])}),this.stride=t.stride}}const et=[A,p,y,F,g,b,M,_,m,w,$,E,T,L,I,v,x,V,D,U,k,G,S,j,z,B,q,J,K,C,N,P,Q,R,W,X];function O(s){return`${s.ElementType}_${s.ElementCount}`}function st(s){return H.get(s)}const H=new Map;et.forEach(s=>H.set(O(s),s));export{c as G,dt as H,ot as I,nt as c,l as e,ht as f,ut as i,at as m,tt as s,ft as u};
