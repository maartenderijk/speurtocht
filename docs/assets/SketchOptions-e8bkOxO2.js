import{mQ as $n,cm as Ie,i4 as mn,eN as A,eO as _,jR as U,ly as bn,mR as Rt,jP as ce,jQ as te,lz as Nn,lG as En,i3 as Ln,aM as wn,aN as xn,eA as Pt,gA as An,w as we,S as St,aS as xe,G as l,H as c,I as W,Q as m,bQ as _t,u as d,kc as Tn,T as fe,hm as M,X as k,gM as L,bP as V,_ as Ae,he as Ge,x as ne,lw as kn,bO as et,i as tt,mi as Ee,jS as Mn,jT as It,dt as Rn,mS as Pn,b4 as Sn,h2 as zt,gG as _n,bV as Ce,N as In,bT as zn,U as jn,hh as On,a4 as qn,A as Hn,id as Bn,mm as $t,cQ as Dn,ck as Un,mT as Vn,e as Zn,mU as Fn,mV as Gn,ew as se,df as Cn,h5 as Wn,mW as Yn,aA as Qn,f2 as Xn,mX as Jn,j5 as Kn}from"./index-BHVnKyhT.js";import{j as Te,q as nt,b as rt,N as We}from"./geodesicUtils-ovsB0bNf.js";import{l as ze,M as I,Q as Ye,d as jt,k as Ot,z as er,p as tr,V as nr,H as qt,O as Ht}from"./plane-CSG-07l9.js";import{I as rr,O as sr,_ as ir,$ as or,U as ar}from"./sphere-Cxz_-0YC.js";import{n as Bt,e as je,a as ke}from"./projectVectorToVector-C7pWyYZJ.js";import{m as st,o as de}from"./quantityUtils-Bkjx7W3f.js";function Dt(t){return t?Oe:vr}function ur(t,e){return e!=null&&e.mode?e.mode:Dt(t).mode}function lr(t,e){return e??Dt(t)}function Ut(t,e){return ur(t==null||(t.hasZ??!1),e)}function ws(t,e){return lr(t==null||(t.hasZ??!1),e)}function xs(t){const e=Zt(t);return Ut(t.geometry,e)}function cr(t){const e=Zt(t),n=Ut(t.geometry,e),r=e!=null&&n!=="on-the-ground"?yr(e):0,s=e==null?void 0:e.featureExpressionInfo;return{mode:n,offset:r,featureExpressionInfo:s}}function As(t){return Vt(cr(t))}function Ts(t){return Vt(t)||pr(t)}function pr(t){var e;return((e=t==null?void 0:t.featureExpressionInfo)==null?void 0:e.expression)==="0"}function Vt(t){if(!t||t.mode==="on-the-ground")return!1;const e=t!=null&&t.featureExpressionInfo?t.featureExpressionInfo.expression:null;return!(!e||e==="0")}function Zt(t){return t.layer&&"elevationInfo"in t.layer?t.layer.elevationInfo:null}function it(t,e){if(!(t!=null&&t.offset))return 0;const{offset:n,unit:r}=t;if(r==="decimal-degrees")return 0;const s=r!=="unknown"&&r?r:"meters",i=$n(e);return i?Ie(n,s,i):0}function ks(t,e,n){if(!(n!=null&&n.mode))return;const r=t.hasZ?t.z:0,s=it(n,t.spatialReference);switch(n.mode){case"absolute-height":return r-s;case"on-the-ground":return 0;case"relative-to-ground":return r-((e.elevationProvider.getElevation(t.x,t.y,r,t.spatialReference,"ground")??0)+s);case"relative-to-scene":return r-((e.elevationProvider.getElevation(t.x,t.y,r,t.spatialReference,"scene")??0)+s)}}function hr(t,e,n,r=null){return ot(t,e.x,e.y,e.hasZ?e.z:0,e.spatialReference,n,r)}function fr(t,e,n,r,s=null){return ot(t,e[0],e[1],e.length>2?e[2]:0,n,r,s)}function ot(t,e,n,r,s,i,a=null){if(i==null)return;const o=a!=null?a.mode:"absolute-height";if(o==="on-the-ground")return 0;const{absoluteZ:u}=dr(e,n,r,s,t,i);return gr(u,e,n,r,s,t,a,o)}function dr(t,e,n,r,s,i){const a=it(i,r);switch(i.mode){case"absolute-height":return{absoluteZ:n+a,elevation:0};case"on-the-ground":{const o=s.elevationProvider.getElevation(t,e,0,r,"ground")??0;return{absoluteZ:o,elevation:o}}case"relative-to-ground":{const o=s.elevationProvider.getElevation(t,e,n,r,"ground")??0;return{absoluteZ:n+o+a,elevation:o}}case"relative-to-scene":{const o=s.elevationProvider.getElevation(t,e,n,r,"scene")??0;return{absoluteZ:n+o+a,elevation:o}}}}function gr(t,e,n,r,s,i,a,o){const u=it(a,s);switch(o){case"absolute-height":return t-u;case"relative-to-ground":return t-((i.elevationProvider.getElevation(e,n,r,s,"ground")??0)+u);case"relative-to-scene":return t-((i.elevationProvider.getElevation(e,n,r,s,"scene")??0)+u)}}function Ms(t,e){if(e==null)return!1;const{mode:n}=e;return n!=null&&(t==="scene"&&n==="relative-to-scene"||t==="ground"&&n!=="absolute-height")}function Rs(t,e,n){return n&&n.mode!==e?`${t} only support ${e} elevation mode`:null}function Ps(t,e,n){return(n==null?void 0:n.mode)===e?`${t} do not support ${e} elevation mode`:null}function Ss(t,e){return(e==null?void 0:e.featureExpressionInfo)!=null&&e.featureExpressionInfo.expression!=="0"?`${t} do not support featureExpressionInfo`:null}function _s(t,e){e&&t.warn(".elevationInfo=",e)}function yr(t){return((t==null?void 0:t.offset)??0)*mn(t==null?void 0:t.unit)}const Oe={mode:"absolute-height",offset:0},vr={mode:"on-the-ground",offset:null};function Ve(t,e){return t[0]*e[1]-t[1]*e[0]}function $r(t,e,n){const r=ce(n,e)/te(n);return Nn(t,n,r)}function Is(t,e,n,r,s=n){return A(ee,r,n),A(Me,e,s),$r(ae,Me,ee),bn(t,s,ae)}function zs(t,e,n,r){A(ee,e,n);const s=r/Rt(ee);return U(t,n,ee,s)}function js(t,e){const n=t.start,r=t.end,s=e.start,i=e.end,a=A(ee,r,n),o=A(Ft,i,s),u=Ve(a,o);if(Math.abs(u)<=br)return[];const p=A(Me,n,s),h=Ve(o,p)/u,f=Ve(a,p)/u;if(h>=0){if(f>=0||e.type===$.LINE)return[U(ae,n,a,h)]}else if(t.type===$.LINE&&(f>=0||e.type===$.LINE))return[U(ae,n,a,h)];return[]}function mr(t,e,n){const r=[],s=A(ee,t.end,t.start),i=A(Ft,t.start,e),a=te(s),o=2*ce(s,i),u=o*o-4*a*(te(i)-n*n);if(u===0){const p=-o/(2*a);(t.type===$.LINE||p>=0)&&r.push(U(ae,t.start,s,p))}else if(u>0){const p=Math.sqrt(u),h=(-o+p)/(2*a);(t.type===$.LINE||h>=0)&&r.push(U(ae,t.start,s,h));const f=(-o-p)/(2*a);(t.type===$.LINE||f>=0)&&r.push(U(Me,t.start,s,f))}return r}var $;(function(t){t[t.RAY=0]="RAY",t[t.LINE=1]="LINE"})($||($={}));const br=1e-6,ee=_(),Ft=_(),Me=_(),ae=_(),Nr="z",Er="r",Os={redo:Er,undo:Nr,center:"Alt",constraint:"Shift",cancel:"Escape",delete:["Backspace","Delete"],complete:"Enter",vertexAdd:"f",pan:" "},mt={toggle:"Control"},qs={enterInputMode:"Tab",commit:"Enter",discard:"Escape",next:"Tab"},Hs={moveUp:{key:"ArrowUp",modifier:"Shift",repeats:!0},moveDown:{key:"ArrowDown",modifier:"Shift",repeats:!0},moveLeft:{key:"ArrowLeft",modifier:"Shift",repeats:!0},moveRight:{key:"ArrowRight",modifier:"Shift",repeats:!0},scaleUp:{key:"+",modifier:"Shift"},scaleDown:{key:"-",modifier:"Shift"},factorModifier:{key:En,continuePropagation:!0},toggleOpacity:"t",preserveAspectRatio:{key:"Shift",continuePropagation:!0},rotateIncrements:{key:"Shift",continuePropagation:!0}};let Bs=class{constructor(){this._bindings=new Map}add(e,n){return this.addToggle(e,r=>{r.type==="key-down"&&n(r)})}addToggle(e,n){const r=Lr.fromDefinition(e,n),s=Ln(this._bindings,r.key,()=>[]);return s.push(r),wn(()=>xn(s,r))}register(e,n=Pt.WIDGET){return An([e.on("key-down",r=>this.dispatch(e.inputManager,r),n),e.on("key-up",r=>this.dispatch(e.inputManager,r),n)])}dispatch(e,n){const r=n.key,s=this._bindings.get(r);if(s)for(const i of s)i.process(e,n)}},Lr=class Qe{constructor(e,n,r,s,i){this.key=e,this.modifiers=n,this.repeats=r,this.continuePropagation=s,this.callback=i}process(e,n){if(!(n.key!==this.key||"repeat"in n&&n.repeat&&!this.repeats)){for(const r of this.modifiers)if(!e.isModifierKeyDown(r))return;this.continuePropagation||n.stopPropagation(),this.callback(n)}}static fromDefinition(e,n){if(typeof e=="string")return new Qe(e,[],!1,!1,n);const{key:r,modifier:s,repeats:i,continuePropagation:a}=e;return new Qe(r,s?Array.isArray(s)?s:[s]:[],!!i,!!a,n)}};var re;function Gt(t,e,n){return P(t,e,n)}function P(t=0,e=0,n=0){return we(t,e,n)}function Us(t){return t}function Vs(t){return t}function J(t,e,n){return we(t,e,n)}function ue(t){const[e,n,r]=t;return t.length>3?[e,n,r,t[3]]:[e,n,r]}function Zs(t){return t[3]=((t.length>3?t[3]:void 0)??re.NONE)|re.TARGET,t}function Fs(t){return!!(((t.length>3?t[3]:void 0)??re.NONE)&re.TARGET)}function bt(t,e,{coordinateHelper:n,elevationInfo:r},s){return t?wr(n.vectorToDehydratedPoint(t,xr),e,r,s):null}function wr(t,e,n,r=P()){return r[0]=t.x,r[1]=t.y,r[2]=t.z??0,e==null||(e.type==="2d"?r[2]=0:r[2]=hr(e,t,n,Oe)??0),r}function Gs(t,e,n){return n?(Bt(n,t[0],t[1],t[2],e),n):je(t[0],t[1],t[2],e)}function Cs(t,e,{z:n,m:r},s,i){const{spatialReference:a,elevationInfo:o}=s;let u;n==null&&r==null?u=void 0:e==null||e.type==="2d"?u=n??void 0:u=fr(e,t,a,Oe,o)??0;const[p,h]=t;return i?Bt(i,p,h,u,a):i=je(p,h,u,a),r!=null&&(i.m=r,i.hasM=!0),i}function Ws(t,e,n,r,s=P()){const[i,a]=t;return s[0]=i,s[1]=a,t.length>3&&(s[3]=t[3]??re.NONE),(n==null?void 0:n.type)!=="3d"?(s[2]=e.value,s):(s[2]=ot(n,i,a,e.value,r,e.elevationInfo,Oe)??0,s)}(function(t){t[t.NONE=0]="NONE",t[t.TARGET=1]="TARGET"})(re||(re={}));const xr=je(0,0,0,null);let O=class extends St{constructor(){super(...arguments),this.enabled=!0}};l([c({type:Boolean})],O.prototype,"enabled",void 0),O=l([W("esri.views.interactive.snapping.Settings.DefaultSnappingAlgorithm")],O);let v=class extends St{constructor(e){super(e),this.lineSnapper=new O,this.parallelLineSnapper=new O,this.rightAngleSnapper=new O,this.rightAngleTriangleSnapper=new O,this.shortLineThreshold=15,this.distance=5,this.pointThreshold=1e-6,this.intersectionParallelLineThreshold=1e-6,this.parallelLineThreshold=1e-6,this.verticalLineThresholdMeters=.3,this.touchSensitivityMultiplier=1.5,this.pointOnLineThreshold=1e-6,this.orange=new xe([255,127,0]),this.orangeTransparent=new xe([255,127,0,.5]),this.lineHintWidthReference=3,this.lineHintWidthTarget=3,this.lineHintFadedExtensions=.3,this.parallelLineHintWidth=2,this.parallelLineHintLength=24,this.parallelLineHintOffset=1.5,this.rightAngleHintSize=24,this.rightAngleHintOutlineSize=1.5,this.satisfiesConstraintScreenThreshold=1}};l([c({type:O,constructOnly:!0,nonNullable:!0,json:{write:!0}})],v.prototype,"lineSnapper",void 0),l([c({type:O,constructOnly:!0,nonNullable:!0,json:{write:!0}})],v.prototype,"parallelLineSnapper",void 0),l([c({type:O,constructOnly:!0,nonNullable:!0,json:{write:!0}})],v.prototype,"rightAngleSnapper",void 0),l([c({type:O,constructOnly:!0,nonNullable:!0,json:{write:!0}})],v.prototype,"rightAngleTriangleSnapper",void 0),l([c({type:Number,nonNullable:!0,range:{min:-1,max:50,step:1},json:{write:!0}})],v.prototype,"shortLineThreshold",void 0),l([c({type:Number,nonNullable:!0,range:{min:-1,max:50,step:1},json:{write:!0}})],v.prototype,"distance",void 0),l([c({type:Number,nonNullable:!0,range:{min:0,max:1e-5},json:{write:!0}})],v.prototype,"pointThreshold",void 0),l([c({type:Number,nonNullable:!0,range:{min:0,max:1e-5},json:{write:!0}})],v.prototype,"intersectionParallelLineThreshold",void 0),l([c({type:Number,nonNullable:!0,range:{min:0,max:1e-5},json:{write:!0}})],v.prototype,"parallelLineThreshold",void 0),l([c({type:Number,nonNullable:!0,range:{min:0,max:1},json:{write:!0}})],v.prototype,"verticalLineThresholdMeters",void 0),l([c({type:Number,nonNullable:!0,range:{min:0,max:10},json:{write:!0}})],v.prototype,"touchSensitivityMultiplier",void 0),l([c({type:Number,nonNullable:!0,range:{min:0,max:1e-5},json:{write:!0}})],v.prototype,"pointOnLineThreshold",void 0),l([c({type:xe,nonNullable:!0})],v.prototype,"orange",void 0),l([c({type:xe,nonNullable:!0})],v.prototype,"orangeTransparent",void 0),l([c({type:Number,nonNullable:!0,range:{min:0,max:10},json:{write:!0}})],v.prototype,"lineHintWidthReference",void 0),l([c({type:Number,nonNullable:!0,range:{min:0,max:10},json:{write:!0}})],v.prototype,"lineHintWidthTarget",void 0),l([c({type:Number,nonNullable:!0,range:{min:0,max:1},json:{write:!0}})],v.prototype,"lineHintFadedExtensions",void 0),l([c({type:Number,nonNullable:!0,range:{min:0,max:10},json:{write:!0}})],v.prototype,"parallelLineHintWidth",void 0),l([c({type:Number,nonNullable:!0,range:{min:0,max:50},json:{write:!0}})],v.prototype,"parallelLineHintLength",void 0),l([c({type:Number,nonNullable:!0,range:{min:0,max:5},json:{write:!0}})],v.prototype,"parallelLineHintOffset",void 0),l([c({type:Number,nonNullable:!0,range:{min:0,max:46},json:{write:!0}})],v.prototype,"rightAngleHintSize",void 0),l([c({type:Number,nonNullable:!0,range:{min:0,max:6},json:{write:!0}})],v.prototype,"rightAngleHintOutlineSize",void 0),l([c({type:Number,nonNullable:!0,range:{min:0,max:5},json:{write:!0}})],v.prototype,"satisfiesConstraintScreenThreshold",void 0),v=l([W("esri.views.interactive.snapping.Settings.Defaults")],v);const Xs=new v;var le;(function(t){t[t.FEATURE=1]="FEATURE",t[t.SELF=2]="SELF",t[t.ALL=3]="ALL"})(le||(le={}));let qe=class{constructor(e,n){this.isDraped=e,this.domain=n}};class Ct extends qe{constructor(e,n,r=le.ALL){super(n,r),this.intersectionPoint=e}equals(e){return e instanceof Ct&&m(this.intersectionPoint,e.intersectionPoint)}}let Ks=class Wt extends qe{constructor(e,n,r,s,i=le.ALL,a=!0,o=!0){super(s,i),this.type=e,this.lineStart=n,this.lineEnd=r,this.fadeLeft=a,this.fadeRight=o}equals(e){return e instanceof Wt&&this.type===e.type&&m(this.lineStart,e.lineStart)&&m(this.lineEnd,e.lineEnd)&&this.fadeLeft===e.fadeLeft&&this.fadeRight===e.fadeRight}get length(){return _t(this.lineStart,this.lineEnd)}},ei=class Yt extends qe{constructor(e,n,r,s=le.ALL){super(r,s),this.lineStart=e,this.lineEnd=n}equals(e){return e instanceof Yt&&m(this.lineStart,e.lineStart)&&m(this.lineEnd,e.lineEnd)}};class Qt extends qe{constructor(e,n,r,s,i=le.ALL){super(s,i),this.previousVertex=e,this.centerVertex=n,this.nextVertex=r}equals(e){return e instanceof Qt&&m(this.previousVertex,e.previousVertex)&&m(this.centerVertex,e.centerVertex)&&m(this.nextVertex,e.nextVertex)}}function at({start:t,end:e,type:n},r,s){const i=[],a=A(ge,e,t),o=A(He,t,r),u=te(a),p=2*ce(a,o),h=p*p-4*u*(te(o)-s*s);if(h===0){const f=-p/(2*u);(n===R.PLANE||f>=0)&&i.push(U(_(),t,a,f))}else if(h>0){const f=Math.sqrt(h),b=(-p+f)/(2*u);(n===R.PLANE||b>=0)&&i.push(U(_(),t,a,b));const g=(-p-f)/(2*u);(n===R.PLANE||g>=0)&&i.push(U(_(),t,a,g))}return i}function Xt(t,e){const n=t.start,r=t.end,s=A(ge,r,n),i=V(De,-s[1],s[0],0),a=e.start,o=e.end,u=M(lt,o,a),p=k(u,i),h=V(on,n[0],n[1],0),f=M(an,h,a),b=k(f,i),g=fe();if(Math.abs(p)<g)return[];const N=L(un,a,u,b/p);if(e.type===$.RAY){const w=M(Xe,N,a);if(k(w,u)<-g)return[]}if(t.type===R.HALF_PLANE){const w=kn(He,N,n);if(ce(w,s)<-g)return[]}return[ne(N)]}function Ar(t,e){return kr(Re(ct,e[2],t),e)}function Jt(t,e){return rn(Re(ct,0,t),Re(Sr,0,e)).map(([r,s])=>Ee(r,s))}function Kt(t,e,n){return tn(t,Re(ct,t[2],e),n)}function en(t,e,n,r=d()){const s=A(ge,t,e),i=Rt(s);return U(r,e,s,i===0?1:n/i),r[2]=t[2],r}function tn(t,{start:e,end:n,type:r},s=d()){const i=M(Be,t,e),a=M(De,n,e),o=k(i,a)/k(a,a);return L(s,e,a,r===$.RAY?Math.max(o,0):o)}const Tr=(()=>{const t=d(),e=d(),n=d();return({start:r,end:s},{center:i,radius:a,normal:o,slicePlane:u})=>{const p=ze(i,o,Pr);if(y(Ye(p,r),0)&&y(Ye(p,s),0)){jt(o,t,e);const f=(N,w)=>(et(n,w,i),It(N,k(n,t),k(n,e)),N),b=mr({start:f(ge,r),end:f(He,s),type:$.LINE},Rn,a),g=[];for(const[N,w]of b){const S=tt(d(),i);L(S,S,t,N),L(S,S,e,w),u&&!X(u,S)||g.push(S)}return g}const h=d();return Ot(p,r,s,h)?!y(_t(h,i),a)||u&&!X(u,h)?[]:[h]:[]}})();function nn({start:t,end:e,type:n},r,s){const i=[],a=et(Be,e,t),o=A(He,t,r),u=te(a),p=2*ce(a,o),h=p*p-4*u*(te(o)-s*s);if(h===0){const f=-p/(2*u);(n===$.LINE||f>=0)&&i.push(L(d(),t,a,f))}else if(h>0){const f=Math.sqrt(h),b=(-p+f)/(2*u);(n===$.LINE||b>=0)&&i.push(L(d(),t,a,b));const g=(-p-f)/(2*u);(n===$.LINE||g>=0)&&i.push(L(d(),t,a,g))}return i}function rn(t,e){const n=t.start,r=t.end,s=e.start,i=e.end,a=M(Be,r,n),o=M(De,i,s),u=M(lt,s,n),p=Ae(on,a,o);if(!y(k(u,p),0))return[];const h=Ge(p);if(y(h,0))return[];const f=Ae(an,u,o),b=k(f,p)/h,g=L(un,n,a,b);if(t.type===$.RAY){const N=M(Xe,g,n);if(k(a,N)<-fe())return[]}if(e.type===$.RAY){const N=M(Xe,g,s);if(k(o,N)<-fe())return[]}return[ne(g)]}function kr({start:t,end:e,type:n},r){const s=M(Be,r,t),i=M(De,e,t),a=Ae(lt,i,s),o=Ge(a)/Ge(i),u=fe();if(o<u)switch(n){case $.LINE:return[ne(r)];case $.RAY:return k(i,s)<-u?[]:[ne(r)]}return[]}function ut(t,e,n,r){const[s,i]=t,[a,o]=n,u=a-s,p=o-i,h=u*u+p*p,f=Math.sqrt(h);if(f>e+r)return[];if(f<Math.abs(e-r))return[];if(y(f,0)&&y(e,r))return[];const b=(e*e-r*r+h)/(2*f),g=Math.sqrt(e*e-b*b),N=g*p/f,w=g*u/f,[S,K]=Mn(ge,t,n,b/f);return y(N,w)?[Ee(S,K)]:[Ee(S+N,K-w),Ee(S-N,K+w)]}function Re(t,e,{start:n,end:r,type:s}){return V(t.start,n[0],n[1],e),V(t.end,r[0],r[1],e),t.type=Rr[s],t}function sn(t,e){return y(t[2],e[2])}function y(t,e){return Tn(Math.abs(t-e),0,fe())}function Mr(t,e){return e.filter(n=>X(t,n))}function X(t,e){return er(t,e)}var R;(function(t){t[t.PLANE=0]="PLANE",t[t.HALF_PLANE=1]="HALF_PLANE"})(R||(R={}));const Rr={[R.PLANE]:$.LINE,[R.HALF_PLANE]:$.RAY},ge=_(),He=_(),Be=d(),De=d(),lt=d(),on=d(),an=d(),un=d(),Xe=d(),Pr=I(),ct={start:d(),end:d(),type:$.LINE},Sr={start:d(),end:d(),type:$.LINE};class z{intersect(e){return Z(this,e)}closestPoints(e){return[this.closestTo(e)]}}class ye extends z{constructor(e){super(),this.point=e}equals(e){return this===e||j(e)&&m(this.point,e.point)}closestTo(){return ue(this.point)}}class pt extends z{constructor(e,n,r){super(),this.start=e,this.end=n,this.lineLike={start:e,end:n,type:r}}equals(e){return this===e||H(e)&&this.lineLike.type===e.lineLike.type&&m(this.start,e.start)&&m(this.end,e.end)}closestTo(e){const n=P();return tn(e,this.lineLike,n),n}}class ln extends pt{constructor(e,n){super(e,n,$.LINE)}}class _r extends pt{constructor(e,n){super(e,n,$.RAY)}}class cn extends z{constructor(e){super(),this.constraints=e}equals(e){return this===e||Je(e)&&_n(this.constraints,e.constraints,(n,r)=>n.equals(r))}closestTo(e){let n,r=1/0;for(const s of this.constraints){const i=s.closestTo(e),a=Ce(e,i);a<r&&(r=a,n=i)}return ue(n??e)}closestPoints(e){return this.constraints.flatMap(n=>n===this?[]:n.closestPoints(e))}}class Ir extends z{constructor(e,n){super(),this.center=e,this.radius=n}equals(e){return this===e||D(e)&&this.center[0]===e.center[0]&&this.center[1]===e.center[1]&&this.radius===e.radius}closestTo(e){const n=P();return en(e,this.center,this.radius,n),n}}class ht extends z{constructor(e,n){super(),this.center=e,this.radius=n}equals(e){return this===e||G(e)&&m(this.center,e.center)&&this.radius===e.radius}closestTo(e){const n=P();return en(e,this.center,this.radius,n),n[2]=this.center[2],n}asCircle(){return new ft(ue(this.center),this.radius,J(0,0,1))}}class ft extends z{constructor(e,n,r,s=void 0){super(),this.center=e,this.radius=n,this.normal=r,this.slicePlane=s}equals(e){return this===e||Y(e)&&m(this.center,e.center)&&m(this.normal,e.normal)&&this.radius===e.radius}closestTo(e){const{center:n,radius:r}=this;qt(this.getPlane(zr),e,Ze);const s=M(Ze,Ze,n),i=zn(s);if(y(i,0))return ue(e);const a=r/Math.sqrt(i),o=P();L(o,n,s,a);const{slicePlane:u}=this;if(u&&!X(u,o)){const p=gt(u,this);return(p==null?void 0:p.closestTo(e))??ue(e)}return o}getPlane(e=I()){return ze(this.center,this.normal,e)}}const Ze=d(),zr=I();class jr extends z{constructor(e){super(),this.z=e}equals(e){return this===e||F(e)&&this.z===e.z}closestTo(e){return J(e[0],e[1],this.z)}getPlane(e=I()){return V(Nt,0,0,this.z),ze(Nt,In,e)}}const Nt=d();class dt extends z{constructor(e,n,r){super(),this.start=e,this.end=n,this.planeLike={start:e,end:n,type:r}}equals(e){return this===e||B(e)&&this.planeLike.type===e.planeLike.type&&m(this.start,e.start)&&m(this.end,e.end)}closestTo(e){const n=P();return Kt(e,this.planeLike,n),n}closestEndTo(e){const{start:n,end:r}=this.planeLike;return Math.sign(ce(A(Or,r,n),A(qr,e,n)))>0?this.end:this.start}getPlane(e=I()){const n=tt(Et,this.end);return n[2]+=1,tr(this.start,this.end,n,e)}getSlicePlane(e=I()){const{start:n,end:r,type:s}=this.planeLike;if(s===R.PLANE)return;const i=V(Et,n[0],n[1],0),a=V(Lt,r[0],r[1],0),o=et(Lt,a,i);return ze(i,o,e),e}}const Or=_(),qr=_(),Et=d(),Lt=d();class ti extends dt{constructor(e,n){super(e,n,R.HALF_PLANE)}}class ni extends dt{constructor(e,n){super(e,n,R.PLANE)}}class Hr extends z{constructor(e,n){super(),this.sphere=sr(e,n)}equals(e){return this===e||C(e)&&ir(this.sphere,e.sphere)}closestTo(e){const n=P();return or(this.sphere,e,n),n}get center(){return ar(this.sphere)}get radius(){return this.sphere[3]}}class Br extends z{constructor(e,n,r){super(),this.start=e,this.end=n,this.getZ=r,this.planeLike={start:e,end:n,type:R.PLANE}}equals(e){return this===e||Pe(e)&&m(this.start,e.start)&&m(this.end,e.end)&&this.getZ===e.getZ}closestTo(e){return Gr(this,e)}addIfOnTheGround(e,n){for(const r of n){const s=this.getZ(r[0],r[1])??0;y(r[2],s)&&(r[2]=s,e.push(r))}}}class Dr extends z{constructor(e,n,r){super(),this._x=e,this._y=n,this._z=r}equals(e){return this===e||us(e)&&this._x===e._x&&this._y===e._y&&this._z===e._z}closestTo([e,n,r]){return Gt(this._x??e,this._y??n,this._z??r)}}class Ur extends z{constructor(e,n,r,s,i){super(),this._origin=e,this._spatialReference=n,this._distanceMeters=r,this._z=s,this._directionDegrees=i}equals(e){return this===e||as(e)&&$t(this._origin,e._origin)&&this._spatialReference===e._spatialReference&&this._distanceMeters===e._distanceMeters&&this._z===e._z&&this._directionDegrees===e._directionDegrees}closestTo([e,n,r]){return It(pe,e,n),$t(pe,this._origin)||this._applyDirectionAndDistance(pe),Gt(pe[0],pe[1],this._z??r)}_applyDirectionAndDistance(e){if(this._directionDegrees!=null&&this._distanceMeters!=null)Te(e,this._origin,this._directionDegrees,this._distanceMeters,this._spatialReference);else if(this._directionDegrees!=null)Zr(e,this._origin,this._directionDegrees,e,this._spatialReference);else if(this._distanceMeters!=null){const{azimuth:n}=nt(Vr,this._origin,e,this._spatialReference);Te(e,this._origin,n??0,this._distanceMeters,this._spatialReference)}}}const pe=[0,0],Vr=new rt;function Zr(t,e,n,r,s){let{azimuth:i,distance:a}=nt(Fr,e,r,s);i??(i=0);let o=a*Math.cos((i-n)*Dn);o=Math.max(0,o),Te(t,e,n,o,s)}const Fr=new rt;function Gr(t,e){const n=P();return Kt(e,t.planeLike,n),n[2]=t.getZ(n[0],n[1])??hn,n}function Z(t,e){if(Je(t)){const n=[];for(const r of t.constraints){const s=r.intersect(e);s&&n.push(s)}return yt(n)}if(Je(e))return Z(e,t);if(Pe(t))return wt(t,e);if(Pe(e))return wt(e,t);if(j(t)){const{point:n}=t;if(j(e))return m(n,e.point)?t:void 0;const r=e.closestTo(n);return Pn(r,n)?t:void 0}if(H(t)){if(j(e))return Z(e,t);if(H(e))return q(rn(t.lineLike,e.lineLike));if(F(e))return Cr(t,e);if(B(e))return q(Xt(e.planeLike,t.lineLike));if(D(e))return q(nn(t.lineLike,e.center,e.radius));if(Y(e))return q(Tr(t.lineLike,e));if(G(e))return Wr(t,e);if(C(e))return Yr(t,e)}else if(F(t)){if(j(e)||H(e))return Z(e,t);if(F(e))return Qr(t,e);if(B(e))return Xr(t,e);if(D(e))return Jr(t,e);if(Y(e))return es(t,e);if(G(e))return Kr(t,e);if(C(e))return ts(t,e)}else if(B(t)){if(j(e)||H(e)||F(e))return Z(e,t);if(B(e))return Fe(Jt(t.planeLike,e.planeLike));if(D(e))return Fe(at(t.planeLike,e.center,e.radius));if(Y(e))return rs(t,e);if(G(e))return ns(t,e);if(C(e))return ss(t,e)}else if(D(t)){if(j(e)||H(e)||F(e)||B(e))return Z(e,t);if(D(e))return Fe(ut(t.center,t.radius,e.center,e.radius));if(Y(e))return void 0;if(G(e))return is(t,e);if(C(e))return void 0}else if(Y(t)){if(j(e)||H(e)||F(e)||B(e)||D(e))return Z(e,t);if(Y(e))return void 0;if(G(e))return e.asCircle(),void 0;if(C(e))return void 0}else if(G(t)){if(j(e)||H(e)||F(e)||B(e)||D(e)||Y(e))return Z(e,t);if(G(e))return os(e,t);if(C(e))return void 0}else if(C(t)){if(j(e)||H(e)||F(e)||B(e)||D(e)||G(e))return Z(e,t);if(C(e))return void 0}}const Cr=(()=>{const t=I();return(e,n)=>{const{start:r,end:s}=e;if(sn(r,s)&&y(r[2],n.z))return e;const i=P();return Ot(n.getPlane(t),r,s,i)?new ye(i):void 0}})();function Wr({lineLike:t},{center:e,radius:n}){const r=e[2];return q(nn(t,e,n).filter(s=>y(s[2],r)))}function Yr({lineLike:t},{sphere:e}){return q(rr(e,t.start,t.end))}const gt=(()=>{const t=On(),e=d(),n=d();return(r,s,i)=>{const{normal:a,center:o,radius:u}=s;jt(a,e,n);const p=Ht(r),h=u*k(p,e),f=u*k(p,n);jn(t,o[0],o[1],o[2],1);const b=qn(r,t),g=Math.hypot(h,f),N=y(g,0);if(y(Ye(r,o),0)){if(N)return s;if(y(u,0))return!i||X(i,o)?new ye(ue(o)):void 0;Ae(e,p,a),Hn(e,e);const Ue=new Array,be=ne(o);L(be,be,e,u),i&&!X(i,be)||Ue.push(be);const Ne=ne(o);return L(Ne,Ne,e,-u),i&&!X(i,Ne)||Ue.push(Ne),q(Ue)}if(N)return;const w=-b/g;if(Math.abs(w)>1||y(w,1))return;const S=Math.atan(h/f),K=Bn(w)-S,vt=Math.PI-K,ve=new Array,$e=d();L($e,o,e,u*Math.cos(K)),L($e,$e,n,u*Math.sin(K)),ve.push($e);const me=d();return L(me,o,e,u*Math.cos(vt)),L(me,me,n,u*Math.sin(vt)),ve.push(me),q(i?Mr(i,ve):ve)}})();function Qr(t,e){return y(t.z,e.z)?t:void 0}function Xr({z:t},{planeLike:e}){const[n,r]=e.start,[s,i]=e.end,a=J(n,r,t),o=J(s,i,t);return e.type===R.PLANE?new ln(a,o):new _r(a,o)}function Jr(t,e){const[n,r]=e.center;return new ht(J(n,r,t.z),e.radius)}function Kr(t,e){return y(e.center[2],t.z)?e:void 0}const es=(()=>{const t=I();return(e,n)=>gt(e.getPlane(t),n,n.slicePlane)})();function ts(t,{center:e,radius:n}){const r=Math.abs(e[2]-t.z);if(r>n&&!y(r,n))return;const s=J(e[0],e[1],t.z),i=Math.sqrt(n**2-r**2);return y(i,0)?void 0:new ht(s,i)}const ns=(()=>{const t=I();return(e,{center:n,radius:r})=>{const s=at(e.planeLike,n,r),i=n[2];e.getSlicePlane(t);const a=new Array;for(const[o,u]of s){const p=[o,u,i];X(t,p)&&a.push(p)}return q(a)}})(),rs=(()=>{const t=I(),e=I();return(n,r)=>gt(n.getPlane(t),r,n.getSlicePlane(e))})(),ss=(()=>{const t=I();return(e,{center:n,radius:r})=>{const s=e.getPlane(t),i=nr(s,n),a=Math.abs(i);if(a>r&&!y(a,r))return;const o=Math.sqrt(r**2-i**2);if(y(o,0)){const h=P();return qt(s,n,h),new ye(h)}const u=P(),p=ne(Ht(s));return L(u,n,p,i),new ft(u,o,p,e.getSlicePlane())}})();function is(t,e){const n=zt(t.center,e.center);return y(n,0)&&y(t.radius,e.radius)?e:pn(ut(t.center,t.radius,e.center,e.radius),e.center[2])}function os(t,e){if(!sn(t.center,e.center))return;const n=zt(t.center,e.center);return y(n,0)&&y(t.radius,e.radius)?t:pn(ut(t.center,t.radius,e.center,e.radius),t.center[2])}function wt(t,e){const{planeLike:n,getZ:r}=t,s=new Array;if(j(e))t.addIfOnTheGround(s,Ar(n,e.point));else if(H(e))t.addIfOnTheGround(s,Xt(n,e.lineLike));else if(D(e))for(const[i,a]of at(n,e.center,e.radius)){const o=r(i,a);o!=null&&s.push(we(i,a,o))}else if(B(e)||Pe(e))for(const[i,a]of Jt(n,e.planeLike)){const o=r(i,a)??hn;s.push(we(i,a,o))}return q(s)}function Fe(t){return yt(t.map(([e,n])=>{const r=J(e,n,0),s=J(e,n,1);return new ln(r,s)}))}function q(t){return yt(t.map(e=>e?new ye(e):void 0))}function pn(t,e){return q(t.map(([n,r])=>[n,r,e]))}function yt(t){if(t.length!==0)return t.length===1?t[0]??void 0:new cn(t.filter(Sn))}function Je(t){return t instanceof cn}function j(t){return t instanceof ye}function H(t){return t instanceof pt}function F(t){return t instanceof jr}function B(t){return t instanceof dt}function D(t){return t instanceof Ir}function G(t){return t instanceof ht}function Y(t){return t instanceof ft}function C(t){return t instanceof Hr}function Pe(t){return t instanceof Br}function as(t){return t instanceof Ur}function us(t){return t instanceof Dr}const hn=0;var T;function ls(t,e){if(t==null||e==null)return;const n=Ke(t,e);return n!=null?de(n,"radians","geographic"):void 0}(function(t){t.Absolute="absolute",t.Relative="relative",t.RelativeBilateral="relative-bilateral"})(T||(T={}));const Ke=(()=>{const t=d(),e=d();return(n,r)=>(V(t,n.x,n.y,n.z??0),V(e,r.x,r.y,r.z??0),cs(t,e,n.spatialReference,r.spatialReference))})(),cs=(()=>{const t=_(),e=d(),n=d();return(r,s,i,a)=>{if(m(r,s))return;const o=We(i),u=We(a);if(o&&u&&Zn(o,u)&&ke(r,i,e,o)&&ke(s,a,n,u)){const{azimuth:h}=nt(hs,e,n,o);return h!=null?Ie(h,"degrees","radians"):void 0}t[0]=s[0]-r[0],t[1]=s[1]-r[1];let p=Fn(Gn,t);return t[0]<0&&(p=fs-p),p}})();function ri(t,e,n,r=T.Absolute){if(e&&n)switch(r){case T.Absolute:return ls(e,n);case T.Relative:return At(xt(t,e,n),T.Relative);case T.RelativeBilateral:return At(xt(t,e,n),T.RelativeBilateral)}}function xt(t,e,n){if(!t||!e||!n)return;const r=Ke(t,e),s=Ke(e,n);return r!=null&&s!=null?de(s-r,"radians","geographic"):void 0}function At(t,e){if(t!=null)switch(e){case T.Absolute:return ps(t);case T.Relative:{const n=Se(t);let r=Tt.normalize(n,0,!0);return r===-180&&(r=180),de(r,"degrees","geographic")}case T.RelativeBilateral:{const n=Se(t),r=Math.abs(Tt.normalize(n,0,!0));return de(r,"degrees","geographic")}}}function ps(t){const e=Se(t),n=ds.normalize(e,0,!0);return de(n,"degrees","geographic")}const si=(()=>{const t=d();return(e,n,r,s,i,a="geodesic")=>{tt(t,n);const o=Se(i);if(a==="geodesic"){const g=We(r);if(g&&ke(t,r,t,g))return Te(e,t,o,s,g),e[2]=n[2],!!ke(e,g,e,r)}const u=st(o,"geographic","arithmetic"),p=Ie(u,"degrees","radians"),h=n[0]+s*Math.cos(p),f=n[1]+s*Math.sin(p),b=n[2];return V(e,h,f,b),!0}})();function Se(t){if(t!=null)return st(fn(t),t.rotationType,"geographic")}function ii(t){if(t!=null)return st(fn(t),t.rotationType,"arithmetic")}function fn(t){return Ie(t.value,t.unit,"degrees")}const hs=new rt,fs=2*Math.PI,ds=Un,Tt=new Vn(-180,180);let Le=class extends se{constructor(e){super(e),this.enabled=!1}};l([c({type:Boolean,nonNullable:!0})],Le.prototype,"enabled",void 0),Le=l([W("esri.views.interactive.sketch.SketchLabelOptions")],Le);const dn=Le,ai=Symbol("grid-placement-graphic");function gs(t,e){const n=t.x-e.x,r=t.y-e.y;return n*n+r*r}function ui(t,e){return Math.sqrt(gs(t,e))}function li(t,e){e.sort((n,r)=>Ce(n.targetPoint,t)-Ce(r.targetPoint,t))}var kt;function ci({point:t,distance:e,returnEdge:n,vertexMode:r,coordinateHelper:{spatialReference:s},filter:i},a,o){return o=o!=null?o.clone():new Qn({where:"1=1"}),i&&(o.geometry=i.geometry,o.distance=i.distance,o.spatialRelationship=i.spatialRelationship,o.where=Xn(o.where,i.where),o.timeExtent=Jn(o.timeExtent,i.timeExtent),o.objectIds=ys(o.objectIds,i.objectIds)),{point:je(t[0],t[1],t[2],s.toJSON()),mode:a,distance:e,returnEdge:n,vertexMode:r,query:o.toJSON()}}function ys(t,e){return t||e?e?t?Array.from(Kn(new Set(t),new Set(e))):e:t:null}function pi(t,e,n){return{left:bt(t.leftVertex.pos,e,n),right:bt(t.rightVertex.pos,e,n)}}(function(t){t[t.TARGET=0]="TARGET",t[t.REFERENCE=1]="REFERENCE",t[t.REFERENCE_EXTENSION=2]="REFERENCE_EXTENSION"})(kt||(kt={}));const Mt=Symbol("snapping-toggle");function hi(t,e=()=>{}){const n=Cn(()=>({view:t.view,snappingOptions:t.snappingOptions}),({view:r,snappingOptions:s})=>{if(t.removeHandles(Mt),!r||!s)return;const i=Pt.TOOL,a=[r.on("key-down",o=>{o.key!==mt.toggle||o.repeat||(s.enabledToggled=!0,e())},i),r.on("key-up",o=>{o.key===mt.toggle&&(s.enabledToggled=!1,e())},i),r.on("pointer-move",o=>{const u=o.native.ctrlKey;s.enabledToggled!==u&&(s.enabledToggled=u,e())},i)];t.addHandles(a,Mt)},Wn);t.addHandles(n)}function fi(t){var e;return Yn(t)&&"utilityNetworks"in t&&!!((e=t.utilityNetworks)!=null&&e.length)}let he=class extends se{constructor(t){super(t),this.mode="absolute-height"}toJSON(){return{mode:this.mode}}};l([c({type:String,nonNullable:!0})],he.prototype,"mode",void 0),he=l([W("esri.views.interactive.sketch.SketchTooltipElevationOptions")],he);let E=class extends se{constructor(t){super(t),this.area=!0,this.coordinates=!0,this.direction=!0,this.distance=!0,this.elevation=!0,this.header=!0,this.helpMessage=!1,this.orientation=!0,this.radius=!0,this.rotation=!0,this.scale=!0,this.size=!0,this.totalLength=!0}};l([c({type:Boolean,nonNullable:!0})],E.prototype,"area",void 0),l([c({type:Boolean,nonNullable:!0})],E.prototype,"coordinates",void 0),l([c({type:Boolean,nonNullable:!0})],E.prototype,"direction",void 0),l([c({type:Boolean,nonNullable:!0})],E.prototype,"distance",void 0),l([c({type:Boolean,nonNullable:!0})],E.prototype,"elevation",void 0),l([c({type:Boolean,nonNullable:!0})],E.prototype,"header",void 0),l([c({type:Boolean,nonNullable:!0})],E.prototype,"helpMessage",void 0),l([c({type:Boolean,nonNullable:!0})],E.prototype,"orientation",void 0),l([c({type:Boolean,nonNullable:!0})],E.prototype,"radius",void 0),l([c({type:Boolean,nonNullable:!0})],E.prototype,"rotation",void 0),l([c({type:Boolean,nonNullable:!0})],E.prototype,"scale",void 0),l([c({type:Boolean,nonNullable:!0})],E.prototype,"size",void 0),l([c({type:Boolean,nonNullable:!0})],E.prototype,"totalLength",void 0),E=l([W("esri.views.interactive.sketch.SketchTooltipVisibleElements")],E);const gn=E;let x=class extends se{constructor(t){super(t),this.enabled=!1,this.forceEnabled=!1,this.helpMessage=null,this.helpMessageIcon=null,this.inputEnabled=!0,this.elevation=new he,this.placement="auto",this.offset=null,this.visibleElements=new gn,this.visualVariables=null,this.xyMode="auto"}get effectiveEnabled(){return this.forceEnabled||this.enabled}};l([c({type:Boolean,nonNullable:!0})],x.prototype,"enabled",void 0),l([c()],x.prototype,"forceEnabled",void 0),l([c()],x.prototype,"effectiveEnabled",null),l([c()],x.prototype,"helpMessage",void 0),l([c()],x.prototype,"helpMessageIcon",void 0),l([c({type:Boolean,nonNullable:!0})],x.prototype,"inputEnabled",void 0),l([c({type:he,nonNullable:!0})],x.prototype,"elevation",void 0),l([c()],x.prototype,"placement",void 0),l([c()],x.prototype,"offset",void 0),l([c({type:gn,nonNullable:!0})],x.prototype,"visibleElements",void 0),l([c()],x.prototype,"visualVariables",void 0),l([c()],x.prototype,"xyMode",void 0),x=l([W("esri.views.interactive.sketch.SketchTooltipOptions")],x);const yn=x;let ie=class extends se{constructor(e){super(e),this.length=null,this.verticalLength=null,this.area=null}};l([c()],ie.prototype,"length",void 0),l([c()],ie.prototype,"verticalLength",void 0),l([c()],ie.prototype,"area",void 0),ie=l([W("esri.views.interactive.sketch.Units")],ie);const _e=ie;let Q=class extends se{constructor(t){super(t),this.directionMode="relative",this.relativeDirectionIsBilateral=!1}get effectiveDirectionMode(){switch(this.directionMode){case"relative":return this.relativeDirectionIsBilateral?T.RelativeBilateral:T.Relative;case"absolute":return T.Absolute}}get displayUnits(){return this._get("displayUnits")??new _e}set displayUnits(t){this._set("displayUnits",t)}get inputUnits(){return this._get("inputUnits")??new _e}set inputUnits(t){this._set("inputUnits",t)}};l([c({type:String,nonNullable:!0})],Q.prototype,"directionMode",void 0),l([c({type:Boolean,nonNullable:!0})],Q.prototype,"relativeDirectionIsBilateral",void 0),l([c()],Q.prototype,"effectiveDirectionMode",null),l([c({type:_e,nonNullable:!0})],Q.prototype,"displayUnits",null),l([c({type:_e,nonNullable:!0})],Q.prototype,"inputUnits",null),Q=l([W("esri.views.interactive.sketch.SketchValueOptions")],Q);const vn=Q;function vs(t){return(t==null?void 0:t.type)==="graphic"}function gi(t){return t.find(vs)??null}let oe=class extends se{constructor(t){super(t),this.labels=new dn,this.tooltips=new yn,this.values=new vn}};l([c({nonNullable:!0,type:dn})],oe.prototype,"labels",void 0),l([c({nonNullable:!0,type:yn})],oe.prototype,"tooltips",void 0),l([c({nonNullable:!0,type:vn})],oe.prototype,"values",void 0),oe=l([W("esri.views.interactive.sketch.SketchOptions")],oe);const yi=oe;export{T as $,Bs as A,Hs as B,fr as C,Br as D,li as E,Ks as F,kt as G,Ct as H,Is as I,tn as J,ei as K,ln as L,si as M,bt as N,Qt as O,Ir as P,wr as Q,ni as R,Cs as S,Vt as T,As as U,hi as V,dn as W,yn as X,vn as Y,js as Z,ps as _,qe as a,At as a0,ks as a1,Se as a2,Dr as a3,yt as a4,jr as a5,ls as a6,ot as a7,Ur as a8,lr as a9,j as aa,hr as ab,cr as ac,dr as ad,ri as ae,qs as af,ii as ag,Ut as ah,_s as ai,Rs as aj,Ss as ak,Ps as al,ws as am,it as an,Ts as ao,vr as ap,Gs as aq,Ws as ar,Fs as as,ur as at,pr as au,Zs as b,P as c,ai as d,J as e,Gt as f,ye as g,ci as h,yi as i,fi as j,le as k,xs as l,ti as m,Oe as n,ui as o,Xs as p,Os as q,Us as r,Vs as s,pi as t,gs as u,cs as v,$ as w,zs as x,Ms as y,gi as z};
